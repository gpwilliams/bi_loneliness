<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="analysis_files/libs/quarto-html/quarto.js"></script>
<script src="analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="supplemental-material" class="level1">
<h1>Supplemental Material</h1>
<p>This document shows the code and results for data processing, model fitting, model selection, and parameter estimation for each model. In addition, all additional statistics (including demographics and descriptives) are reported here along with model diagnostics for the final, reported model.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aesara</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aesara.tensor <span class="im">as</span> at</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"We used Python [Version </span><span class="sc">{</span>python_version()<span class="sc">}</span><span class="ss">] and the Python packages PyMC [Version </span><span class="sc">{</span>pm<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">], ArviZ [Version </span><span class="sc">{</span>az<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">], NumPy [Version </span><span class="sc">{</span>np<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">], pandas [Version </span><span class="sc">{</span>pd<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">], Aesara [Version </span><span class="sc">{</span>aesara<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">], Matplotlib [Version </span><span class="sc">{</span>matplotlib<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">], and seaborn [Version </span><span class="sc">{</span>sns<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">] for all data processing, analysis, and presentation."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We used Python [Version 3.9.5] and the Python packages PyMC [Version 4.1.7], ArviZ [Version 0.12.1], NumPy [Version 1.23.2], pandas [Version 1.4.4], Aesara [Version 2.8.2], Matplotlib [Version 3.5.3], and seaborn [Version 0.11.2] for all data processing, analysis, and presentation.</code></pre>
</div>
</div>
</section>
<section id="data-processing" class="level1">
<h1>Data Processing</h1>
<p>First we read in the data, removing participant 15 who did not suffer from brain injury but took part in the study regardless. We ensure that the results are reproducible by setting a random seed.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>az.style.use(<span class="st">'arviz-darkgrid'</span>) <span class="co"># styling on plots</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>) <span class="co"># suppress warnings</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># options and reproducibility info for PyMC</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>CHAINS <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>SEED <span class="op">=</span> <span class="dv">1892</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>SAMPLE_KWARGS <span class="op">=</span> {</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'draws'</span>: <span class="dv">3000</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tune'</span>: <span class="dv">1000</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'chains'</span>: CHAINS,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'random_seed'</span>: <span class="bu">list</span>(SEED <span class="op">+</span> np.arange(CHAINS)),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'return_inferencedata'</span>: <span class="va">True</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read data, remove P15, fix data types, center DJG for continuous models</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> pd.read_csv(<span class="st">'../data/cleaned-results.csv'</span>).query(<span class="st">'PID != "P15"'</span>).convert_dtypes() </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dat[<span class="st">'DJG'</span>] <span class="op">=</span> dat[<span class="st">'DJG'</span>].astype(<span class="bu">float</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>dat[<span class="st">'DJG_c'</span>] <span class="op">=</span> dat[<span class="st">'DJG'</span>] <span class="op">-</span> dat[<span class="st">'DJG'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we create the monotonic preedictor from the De Jong Gierveld (DJG) categories present in the data. There are 7 categories ranging from 0-6. Thus, 6 simplex parameters need to be created prior to data modelling.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the simplex parameters for the DJG data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(dat.DJG.astype(<span class="bu">int</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ncat <span class="op">=</span> <span class="bu">len</span>(np.unique(X))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ncat <span class="op">-</span><span class="dv">1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>con_simo <span class="op">=</span> np.ones(df)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Xmo <span class="op">=</span> np.zeros((<span class="bu">len</span>(X), ncat), <span class="bu">int</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ic, i <span class="kw">in</span> <span class="bu">enumerate</span>(X):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        Xmo[ic, :i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> np.arange(i <span class="op">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Brief Resilience scale (Smith et al., 2013) is scored such that values from 1-2.99 are categorised as low, values from 3-4.30 are categorised as normal, and values of 4.31-5 are categorised as high in resilience. However, with only 1 participant with a score in this high range we collapsed the categories into “low” (-1) and “normal-to-high” (+1) using sum coding. Here, the cutoff is defined as any scores below 3 are “low” and any scores of 3 or more are categorised as normal-to-high.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dat[<span class="st">'BRS_cat'</span>] <span class="op">=</span> np.asarray(np.where(dat[<span class="st">'BRS'</span>] <span class="op">&lt;</span> <span class="dv">3</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># difference coding</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>brs_obs <span class="op">=</span> dat[<span class="st">'BRS_cat'</span>].values.astype(np.float64) <span class="co"># float64 needed for resampling</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>djg_obs <span class="op">=</span> dat[<span class="st">'DJG_c'</span>].values.astype(np.float64)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>WEMWBS_obs <span class="op">=</span> dat[<span class="st">'WEMWBS'</span>].values.astype(np.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-modelling" class="level1">
<h1>Data Modelling</h1>
<p>First, we defined our maximal model. This takes the form of a Bayesian model estimating monotonic effects of the De Jong Grieveld (DJG) predictor and with the categorical predictor of Brief Resilience Scale (BRS) category. The DJG predictor is estimated using monotonic effects as effects are assumed to have a monotonically increasing relationship with the response, and because this predictor is made up of a limited range of categories which cannot be assumed to be linearly related nor can be assumed to be unrelated categories (Burkner &amp; Charpentier, 2020). Indeed, Burkner and Charpenier note that this model specification is particularly useful with Likert-scale data. The model thus captures and summarises the monotinic effects in terms of two parameters: <span class="math inline">\(\hat{\beta}\)</span> estimaging the magnitude and direction of effect as with typical regression parameter estimates, and <span class="math inline">\(\zeta\)</span> which is a vector estimating the normalised distances between consecutive categories in the predictor.</p>
<p>Given that the BRS only has 3 categories – low, medium, and high – and we have only 1 observation in the high category we collaped this predictor into a simple categorical predictor with the categories low and medium-high. The categorical predictor of BRS was sum-coded (low = -1, medium-high = 1) prior to model fitting. With this model specification, the intercept represents the grand mean collapsed across BRS categories.</p>
<p>This model used a <em>Normal</em>(40, 10) prior on the intercept, a <em>Normal</em>(0, 2.5) prior on the DJG monotonic predictors, a <em>Normal</em>(0, 10) prior on the BRS predictor, a <em>Dirichlet</em>([1 … 1]) prior on the vector of the simplex monotonic categories, and an <em>Exponential</em>(1) prior for the standard deviation term. We compared this model with three other possible models: one removing the effect of DJG, one removing the effect of BRS, and one removing the effects for both DJG and BRS.</p>
<p>We also fitted a model treating the DJG predictor as a continuous variable as is common in psychological research. Given the small sample size this may indeed be more appropriate than treating DJG as a monotonic predictor as fewer parameters need to be estimated. Crucially, we centred the DJG predictor such that the intercept represents the grand mean in the same instead of the mean of BRS when DJG = 0. This model used the same priors as the full monotonic model with the exception that no Drichlet prior need be used as simplex monotonic categories were not estimated. We similarly created a reduced version of this model with only DJG as a continuous predictor for full model comparison.</p>
<p>Model comparison was performed using Pareto-smoothed importance sampling leave-one-out cross-validation (PSIS-LOO-CV) to establish which of these models makes the best out-of-sample predictions given the data and priors.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> aesara.shared(np.zeros(<span class="dv">1</span>,))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model: this way is best as it also allows for new data for counterfactual plots using pm.data</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> full_m_model:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    brs <span class="op">=</span> pm.Data(<span class="st">"brs"</span>, brs_obs)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    wemwbs <span class="op">=</span> pm.Data(<span class="st">"wemwbs"</span>, WEMWBS_obs)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">'intercept'</span>, mu<span class="op">=</span><span class="fl">40.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    beta_DJG <span class="op">=</span> pm.Normal(<span class="st">'beta_DJG'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    beta_BRS <span class="op">=</span> pm.Normal(<span class="st">'beta_BRS'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.Exponential(<span class="st">'sigma'</span>, lam<span class="op">=</span><span class="fl">1.</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    simo_t <span class="op">=</span> pm.Dirichlet(<span class="st">'simo'</span>, a<span class="op">=</span>con_simo)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    simo <span class="op">=</span> at.concatenate([a, simo_t])</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> intercept <span class="op">+</span> beta_BRS <span class="op">*</span> brs <span class="op">+</span> beta_DJG <span class="op">*</span> at.<span class="bu">sum</span>(simo[Xmo], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> pm.Normal(<span class="st">'Y'</span>, mu<span class="op">=</span>mu, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>wemwbs)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    full_m_trace <span class="op">=</span> pm.sample(<span class="op">**</span>SAMPLE_KWARGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, beta_DJG, beta_BRS, sigma, simo]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="16000" class="" max="16000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [16000/16000 00:05&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 3_000 draw iterations (4_000 + 12_000 draws total) took 24 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> full_c_model:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    brs <span class="op">=</span> pm.Data(<span class="st">"brs"</span>, brs_obs)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    djg <span class="op">=</span> pm.Data(<span class="st">"djg"</span>, djg_obs)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    wemwbs <span class="op">=</span> pm.Data(<span class="st">"wemwbs"</span>, WEMWBS_obs)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">'intercept'</span>, mu<span class="op">=</span><span class="fl">40.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    beta_DJG <span class="op">=</span> pm.Normal(<span class="st">'beta_DJG'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    beta_BRS <span class="op">=</span> pm.Normal(<span class="st">'beta_BRS'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.Exponential(<span class="st">'sigma'</span>, lam<span class="op">=</span><span class="fl">1.</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> intercept <span class="op">+</span> beta_DJG <span class="op">*</span> djg <span class="op">+</span> beta_BRS <span class="op">*</span> brs</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> pm.Normal(<span class="st">'Y'</span>, mu<span class="op">=</span>mu, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>wemwbs)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    full_c_trace <span class="op">=</span> pm.sample(<span class="op">**</span>SAMPLE_KWARGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, beta_DJG, beta_BRS, sigma]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="16000" class="" max="16000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [16000/16000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 3_000 draw iterations (4_000 + 12_000 draws total) took 18 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>az.summary(full_c_trace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>intercept</th>
      <td>42.205</td>
      <td>1.820</td>
      <td>38.835</td>
      <td>45.748</td>
      <td>0.020</td>
      <td>0.014</td>
      <td>8321.0</td>
      <td>8152.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>beta_DJG</th>
      <td>-1.368</td>
      <td>0.856</td>
      <td>-2.930</td>
      <td>0.291</td>
      <td>0.008</td>
      <td>0.006</td>
      <td>12199.0</td>
      <td>8988.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>beta_BRS</th>
      <td>6.307</td>
      <td>1.849</td>
      <td>2.998</td>
      <td>9.968</td>
      <td>0.020</td>
      <td>0.014</td>
      <td>8298.0</td>
      <td>7815.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>7.766</td>
      <td>1.010</td>
      <td>5.953</td>
      <td>9.634</td>
      <td>0.010</td>
      <td>0.007</td>
      <td>9904.0</td>
      <td>8561.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> brs_only_model:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    brs <span class="op">=</span> pm.Data(<span class="st">"brs"</span>, brs_obs)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    wemwbs <span class="op">=</span> pm.Data(<span class="st">"wemwbs"</span>, WEMWBS_obs)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">'intercept'</span>, mu<span class="op">=</span><span class="fl">40.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    beta_BRS <span class="op">=</span> pm.Normal(<span class="st">'beta_BRS'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.Exponential(<span class="st">'sigma'</span>, lam<span class="op">=</span><span class="fl">1.</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> intercept <span class="op">+</span> beta_BRS <span class="op">*</span> brs</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> pm.Normal(<span class="st">'Y'</span>, mu<span class="op">=</span>mu, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>wemwbs)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    brs_only_trace <span class="op">=</span> pm.sample(<span class="op">**</span>SAMPLE_KWARGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, beta_BRS, sigma]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="16000" class="" max="16000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [16000/16000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 3_000 draw iterations (4_000 + 12_000 draws total) took 20 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> djg_m_only_model:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    wemwbs <span class="op">=</span> pm.Data(<span class="st">"wemwbs"</span>, WEMWBS_obs)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">'intercept'</span>, mu<span class="op">=</span><span class="fl">40.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    beta_DJG <span class="op">=</span> pm.Normal(<span class="st">'beta_DJG'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.Exponential(<span class="st">'sigma'</span>, lam<span class="op">=</span><span class="fl">1.</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    simo_t <span class="op">=</span> pm.Dirichlet(<span class="st">'simo'</span>, a<span class="op">=</span>con_simo)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    simo <span class="op">=</span> at.concatenate([a, simo_t])</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> intercept <span class="op">+</span> beta_DJG <span class="op">*</span> at.<span class="bu">sum</span>(simo[Xmo], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> pm.Normal(<span class="st">'Y'</span>, mu<span class="op">=</span>mu, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>wemwbs)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    djg_m_only_trace <span class="op">=</span> pm.sample(<span class="op">**</span>SAMPLE_KWARGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, beta_DJG, sigma, simo]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="16000" class="" max="16000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [16000/16000 00:04&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 3_000 draw iterations (4_000 + 12_000 draws total) took 22 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> djg_c_only_model:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    djg <span class="op">=</span> pm.Data(<span class="st">"djg"</span>, djg_obs)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    wemwbs <span class="op">=</span> pm.Data(<span class="st">"wemwbs"</span>, WEMWBS_obs)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">'intercept'</span>, mu<span class="op">=</span><span class="fl">40.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    beta_DJG <span class="op">=</span> pm.Normal(<span class="st">'beta_DJG'</span>, mu<span class="op">=</span><span class="fl">0.</span>, sigma<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.Exponential(<span class="st">'sigma'</span>, lam<span class="op">=</span><span class="fl">1.</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> intercept <span class="op">+</span> beta_DJG <span class="op">*</span> djg</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> pm.Normal(<span class="st">'Y'</span>, mu<span class="op">=</span>mu, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>wemwbs)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    djg_c_only_trace <span class="op">=</span> pm.sample(<span class="op">**</span>SAMPLE_KWARGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, beta_DJG, sigma]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="16000" class="" max="16000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [16000/16000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 3_000 draw iterations (4_000 + 12_000 draws total) took 19 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> intercept_only_model:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    wemwbs <span class="op">=</span> pm.Data(<span class="st">"wemwbs"</span>, WEMWBS_obs)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">'intercept'</span>, mu<span class="op">=</span><span class="fl">40.</span>, sigma<span class="op">=</span><span class="fl">10.</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.Exponential(<span class="st">'sigma'</span>, lam<span class="op">=</span><span class="fl">1.</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> intercept</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> pm.Normal(<span class="st">'Y'</span>, mu<span class="op">=</span>mu, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>wemwbs)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    intercept_only_trace <span class="op">=</span> pm.sample(<span class="op">**</span>SAMPLE_KWARGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [intercept, sigma]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="16000" class="" max="16000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [16000/16000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 3_000 draw iterations (4_000 + 12_000 draws total) took 18 seconds.</code></pre>
</div>
</div>
<p>We results of the LOO-PSIS model comparison are shown below.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>comp_loo <span class="op">=</span> az.compare({</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Full (DJG monotonic)"</span>: full_m_trace, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Full (DJG continuous)"</span>: full_c_trace,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"BRS only"</span>: brs_only_trace, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"DJG (monotonic) only"</span>: djg_m_only_trace,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"DJG (continuous) only"</span>: djg_c_only_trace, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Intercept only"</span>: intercept_only_trace</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    }, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    ic <span class="op">=</span> <span class="st">'loo'</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>comp_loo.<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>rank</th>
      <th>loo</th>
      <th>p_loo</th>
      <th>d_loo</th>
      <th>weight</th>
      <th>se</th>
      <th>dse</th>
      <th>warning</th>
      <th>loo_scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Full (DJG continuous)</th>
      <td>0</td>
      <td>-88.694</td>
      <td>3.955</td>
      <td>0.000</td>
      <td>0.576</td>
      <td>4.560</td>
      <td>0.000</td>
      <td>False</td>
      <td>log</td>
    </tr>
    <tr>
      <th>Full (DJG monotonic)</th>
      <td>1</td>
      <td>-89.030</td>
      <td>3.576</td>
      <td>0.336</td>
      <td>0.000</td>
      <td>4.736</td>
      <td>1.091</td>
      <td>False</td>
      <td>log</td>
    </tr>
    <tr>
      <th>BRS only</th>
      <td>2</td>
      <td>-89.176</td>
      <td>3.347</td>
      <td>0.482</td>
      <td>0.246</td>
      <td>4.698</td>
      <td>1.315</td>
      <td>False</td>
      <td>log</td>
    </tr>
    <tr>
      <th>DJG (continuous) only</th>
      <td>3</td>
      <td>-92.055</td>
      <td>2.851</td>
      <td>3.361</td>
      <td>0.178</td>
      <td>3.747</td>
      <td>3.536</td>
      <td>False</td>
      <td>log</td>
    </tr>
    <tr>
      <th>DJG (monotonic) only</th>
      <td>4</td>
      <td>-92.745</td>
      <td>2.299</td>
      <td>4.051</td>
      <td>0.000</td>
      <td>4.095</td>
      <td>3.868</td>
      <td>False</td>
      <td>log</td>
    </tr>
    <tr>
      <th>Intercept only</th>
      <td>5</td>
      <td>-93.074</td>
      <td>2.143</td>
      <td>4.381</td>
      <td>0.000</td>
      <td>4.116</td>
      <td>3.960</td>
      <td>False</td>
      <td>log</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The model comparisons are possibly easier to interpret in graphical form. Here, the best performing model is at the top, with each model following this in order of goodness of fit. The vertical grey line shows the log LOO-PSIS estimate for the best performing model; here, the full model treating DJG as a continuous predictor. Black dots indicate the LOO estimate with the black horizontal bars indicating the standard error around this estimate. The grey triangle indicates the estimate of the difference between each model and the best performing model, with the horizontal grey bars again indicating the standard error of this contrast.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>loo_plot <span class="op">=</span> az.plot_compare(comp_loo, insample_dev <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_loo.png'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>loo_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;AxesSubplot:xlabel='Log'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>This shows that treating DJG as a continuous rather than monotonic predictor provides a minimal advantage in terms of model fit. Most notably, while the DJG-only and intercept-only models perform worse than the full models, there is practically no difference in the fit between the full and BRS only models. Observing the output of the highest ranked model, it is apparent why the specification of the DJG predictor is of little impact and why the BRS only model shows little difference in terms of LOO to both full models: while the DJG predictor is consistently negative in both full models it is not reliably different to zero, with the 95% HDI spanning from negative to postive values.</p>
<p>In the continuous model there is less uncertainty in the estimate for the effect of DJG on WEMWBS. Thus, across the two full models, while there is evidence for a small, negative effect of DJG on WEMWBS, there is little evidence that this effect is reliably different from zero. Conversely, across both full models and the BRS only model there is consistent evidence that BRS positively contributes to WEMWBS scores, with an average effect of an increase in WEMWBS of at least 14.6 (6.3 <span class="math inline">\(\times\)</span> 2) when going from low to medium-high resilience.</p>
<p>Notably, in all estimates the intercept is over the threshold of 40 which Taggart et al.&nbsp;(2015) suggest as a cutoff whereby scores at 40 or lower indicate a risk of depression. This indicates that participants are, on average, reasonably healthy in terms of mental wellbeing.</p>
<p>For completeness we show the results of all three models, but report only the top one (DJG continuous) in the report. In all models the bulk and tail ESS and <span class="math inline">\(\hat{R}\)</span> show that the model converged well.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>trace_summaries <span class="op">=</span> [full_c_trace, full_m_trace, brs_only_trace]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply az.summary to each trace and save as data frame</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>summary_dfs <span class="op">=</span> []</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>summary_names <span class="op">=</span> [<span class="st">"Full (DJG continuous)"</span>, <span class="st">"Full (DJG monotonic)"</span>, <span class="st">"BRS only"</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>loop_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> trace <span class="kw">in</span> trace_summaries:</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    summary_dfs.append(az.summary(trace, hdi_prob<span class="op">=</span><span class="fl">.95</span>).<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add each summary names ID to the data frame in the first position</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    summary_dfs[loop_count].insert(<span class="dv">0</span>, <span class="st">"model"</span>, summary_names[loop_count])</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    loop_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the data frames, make the parameter rownames a col, then put model col first</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>summary_dfs <span class="op">=</span> pd.concat(summary_dfs)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>summary_dfs <span class="op">=</span> summary_dfs.rename_axis(<span class="st">"parameter"</span>).reset_index()</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>summary_dfs.insert(<span class="dv">0</span>, <span class="st">"model"</span>, summary_dfs.pop(<span class="st">"model"</span>))</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>summary_dfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>model</th>
      <th>parameter</th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_2.5%</th>
      <th>hdi_97.5%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Full (DJG continuous)</td>
      <td>intercept</td>
      <td>42.20</td>
      <td>1.82</td>
      <td>38.47</td>
      <td>45.70</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>8321.0</td>
      <td>8152.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Full (DJG continuous)</td>
      <td>beta_DJG</td>
      <td>-1.37</td>
      <td>0.86</td>
      <td>-2.98</td>
      <td>0.37</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>12199.0</td>
      <td>8988.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Full (DJG continuous)</td>
      <td>beta_BRS</td>
      <td>6.31</td>
      <td>1.85</td>
      <td>2.67</td>
      <td>9.97</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>8298.0</td>
      <td>7815.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Full (DJG continuous)</td>
      <td>sigma</td>
      <td>7.77</td>
      <td>1.01</td>
      <td>5.89</td>
      <td>9.75</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>9904.0</td>
      <td>8561.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Full (DJG monotonic)</td>
      <td>intercept</td>
      <td>42.74</td>
      <td>2.23</td>
      <td>38.34</td>
      <td>47.24</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>8648.0</td>
      <td>8138.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Full (DJG monotonic)</td>
      <td>beta_DJG</td>
      <td>-1.54</td>
      <td>2.31</td>
      <td>-6.11</td>
      <td>2.90</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>10487.0</td>
      <td>9160.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Full (DJG monotonic)</td>
      <td>beta_BRS</td>
      <td>6.72</td>
      <td>1.86</td>
      <td>3.04</td>
      <td>10.32</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>10422.0</td>
      <td>8759.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Full (DJG monotonic)</td>
      <td>sigma</td>
      <td>7.91</td>
      <td>1.02</td>
      <td>5.91</td>
      <td>9.85</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>10932.0</td>
      <td>8422.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Full (DJG monotonic)</td>
      <td>simo[0]</td>
      <td>0.17</td>
      <td>0.14</td>
      <td>0.00</td>
      <td>0.45</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>8800.0</td>
      <td>5464.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Full (DJG monotonic)</td>
      <td>simo[1]</td>
      <td>0.16</td>
      <td>0.14</td>
      <td>0.00</td>
      <td>0.44</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>8373.0</td>
      <td>5061.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Full (DJG monotonic)</td>
      <td>simo[2]</td>
      <td>0.18</td>
      <td>0.15</td>
      <td>0.00</td>
      <td>0.47</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>8508.0</td>
      <td>5546.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Full (DJG monotonic)</td>
      <td>simo[3]</td>
      <td>0.17</td>
      <td>0.14</td>
      <td>0.00</td>
      <td>0.46</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>8651.0</td>
      <td>5175.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Full (DJG monotonic)</td>
      <td>simo[4]</td>
      <td>0.16</td>
      <td>0.14</td>
      <td>0.00</td>
      <td>0.44</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>9742.0</td>
      <td>5960.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Full (DJG monotonic)</td>
      <td>simo[5]</td>
      <td>0.16</td>
      <td>0.14</td>
      <td>0.00</td>
      <td>0.44</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>12843.0</td>
      <td>8805.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>BRS only</td>
      <td>intercept</td>
      <td>41.92</td>
      <td>1.86</td>
      <td>38.27</td>
      <td>45.62</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>8444.0</td>
      <td>8400.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>BRS only</td>
      <td>beta_BRS</td>
      <td>6.85</td>
      <td>1.87</td>
      <td>3.06</td>
      <td>10.47</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>8065.0</td>
      <td>8158.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>BRS only</td>
      <td>sigma</td>
      <td>7.99</td>
      <td>1.00</td>
      <td>6.25</td>
      <td>10.06</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>10459.0</td>
      <td>8124.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Again, in the report only the estimates from the best model (DJG continuous) are reported.</p>
<p>Below, we report the descriptive statistics for the WEMWBS scores for those in the low and medium-high BRS categories. In line with the model estimates, this shows that there is an approximately 14 point difference in WEMWBS scores in the low and medium-high BRS categories.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make dat.BRS_cat a categorical variable with labels low and medium</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dat[<span class="st">'brs_categorical'</span>] <span class="op">=</span> pd.Categorical(dat[<span class="st">'BRS_cat'</span>])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dat[<span class="st">'brs_categorical'</span>] <span class="op">=</span> dat[<span class="st">'brs_categorical'</span>].cat.rename_categories([<span class="st">'low'</span>, <span class="st">'medium-high'</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>dat.groupby(<span class="st">'brs_categorical'</span>).agg({<span class="st">'WEMWBS'</span>: [<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">WEMWBS</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>count</th>
    </tr>
    <tr>
      <th>brs_categorical</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>low</th>
      <td>34.833333</td>
      <td>7.884584</td>
      <td>6</td>
    </tr>
    <tr>
      <th>medium-high</th>
      <td>48.944444</td>
      <td>9.276613</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="demographics" class="level1">
<h1>Demographics</h1>
<p>Below are the age, gender, and time since brain injury demographics for the study.</p>
<p>First, the descriptive statistics for age.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dat.agg({</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Age'</span>: [<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'std'</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>48.75</td>
    </tr>
    <tr>
      <th>min</th>
      <td>24.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>68.00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11.09</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Next, the time since brain injury median and interquartile range.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dat[<span class="st">'time_since_bi'</span>] <span class="op">=</span> <span class="dv">2021</span> <span class="op">-</span> dat[<span class="st">'BI_Date'</span>]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>q3, q1 <span class="op">=</span> np.percentile(dat[<span class="st">'time_since_bi'</span>], [<span class="dv">75</span> ,<span class="dv">25</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>iqr <span class="op">=</span> q3 <span class="op">-</span> q1</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make data frame with time sicne bi median</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>bi_demographics <span class="op">=</span> dat.agg({<span class="st">'time_since_bi'</span>: [<span class="st">'median'</span>]}).rename(columns<span class="op">=</span>{<span class="st">'time_since_bi'</span>: <span class="st">'median_time_since_bi'</span>})</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>bi_demographics.insert(<span class="dv">1</span>, <span class="st">'iqr'</span>, iqr)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>bi_demographics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>median_time_since_bi</th>
      <th>iqr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>median</th>
      <td>5.5</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Finally, the counts of genders.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dat.groupby(<span class="st">'Gender'</span>).agg({<span class="st">'Gender'</span>: [<span class="st">'count'</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Gender</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>8</td>
    </tr>
    <tr>
      <th>M</th>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="brain-injury-and-fitness-to-work" class="level2">
<h2 class="anchored" data-anchor-id="brain-injury-and-fitness-to-work">Brain Injury and Fitness to Work</h2>
<p>Below we show the counts for the severity of brain injury.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>severity <span class="op">=</span> sns.catplot(x <span class="op">=</span> <span class="st">"BI Severity"</span>, data <span class="op">=</span> dat, kind <span class="op">=</span> <span class="st">"count"</span>, height <span class="op">=</span> <span class="dv">6</span>, aspect <span class="op">=</span> <span class="dv">15</span><span class="op">/</span><span class="dv">8</span>, color <span class="op">=</span> <span class="st">'gray'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>severity.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Brain Injury Severity'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_severity.png'</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>severity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x16ba87a30&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Finally, we ask how many participants are fit to work.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"There are </span><span class="sc">{</span>dat[<span class="st">'Employment'</span>]<span class="sc">.</span><span class="bu">str</span><span class="sc">.</span>contains(<span class="st">'Medically Retired|Long Term Sick Leave'</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> participants out of </span><span class="sc">{</span><span class="bu">len</span>(dat)<span class="sc">}</span><span class="ss"> who are medically retired or on long term sick leave."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 7 participants out of 24 who are medically retired or on long term sick leave.</code></pre>
</div>
</div>
<p>Below we show the counts for impairments.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dat_impair <span class="op">=</span> pd.concat([dat[<span class="st">'PID'</span>], dat.loc[:, <span class="st">'Vision'</span>: <span class="st">'Pain'</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>dat_impair_sum <span class="op">=</span> pd.melt(dat_impair, id_vars<span class="op">=</span>[<span class="st">'PID'</span>], var_name<span class="op">=</span><span class="st">'Impairment'</span>, value_name<span class="op">=</span><span class="st">'Count'</span>).query(<span class="st">'Count == 1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>impairments <span class="op">=</span> sns.catplot(x <span class="op">=</span> <span class="st">"Impairment"</span>, data <span class="op">=</span> dat_impair_sum, kind <span class="op">=</span> <span class="st">"count"</span>, height <span class="op">=</span> <span class="dv">6</span>, aspect <span class="op">=</span> <span class="dv">15</span><span class="op">/</span><span class="dv">8</span>, color <span class="op">=</span> <span class="st">'gray'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>impairments.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Impairment'</span>, ylabel<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_impairments.png'</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>impairments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x16c25c9d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="effects-of-brs-and-djg-on-wemwbs" class="level1">
<h1>Effects of BRS and DJG on WEMWBS</h1>
<p>Below, we show plots for the effect of each predictor on WEMWBS. First, the effect of BRS on WEMWBS. First, we get posterior draws for all parameters in the model which we will use for plotting.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> full_c_model:</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    ppc <span class="op">=</span> pm.sample_posterior_predictive(full_c_trace, var_names<span class="op">=</span>[<span class="st">"Y"</span>, <span class="st">"intercept"</span>, <span class="st">"beta_BRS"</span>, <span class="st">"beta_DJG"</span>], random_seed <span class="op">=</span> SEED)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="12000" class="" max="12000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [12000/12000 00:00&lt;00:00]
    </div>
    
</div>
</div>
<p>Next, we define a plotting function for matplotlib to fit a straight line for our predictions.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make function for drawing a straight line</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_line(intercept, slope, <span class="op">*</span>, ax, <span class="op">**</span>SAMPLE_KWARGS):</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    ax.axline((<span class="dv">0</span>, intercept), slope<span class="op">=</span>slope, <span class="op">**</span>SAMPLE_KWARGS)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We plot the model predictions and samples from the posterior for the effect of centred DJG on WEMWBS</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(djg_obs, WEMWBS_obs)<span class="op">;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># draw straight line from intercept and slope</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>plot_line(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    full_c_trace.posterior.intercept.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)), </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    full_c_trace.posterior.beta_DJG.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)), </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="st">'C1'</span>, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">'Posterior expected value'</span>, </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> b0, b1 <span class="kw">in</span> (full_c_trace.posterior[[<span class="st">"intercept"</span>, <span class="st">"beta_DJG"</span>]]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                        .sel(chain<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                        .thin(<span class="dv">100</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                        .to_array().T):</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    plot_line(</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        b0.values, </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        b1.values, </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        c<span class="op">=</span><span class="st">'C2'</span>, </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        alpha<span class="op">=</span><span class="fl">0.25</span>, </span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="op">-</span><span class="fl">3.3</span>, <span class="fl">3.3</span>)<span class="op">;</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Posterior predictive check for DJG on WEMWBS"</span>)<span class="op">;</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_pp_check_DJG.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We then get the estimates and 95% credible interval aroudn the estimate for the effet of BRS on WEMWBS for each category.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get mean and hdi for the plot</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>low_brs_mean <span class="op">=</span> full_c_trace.posterior.intercept.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)) <span class="op">-</span> full_c_trace.posterior.beta_BRS.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)).values</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>medhigh_brs_mean <span class="op">=</span> full_c_trace.posterior.intercept.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)) <span class="op">+</span> full_c_trace.posterior.beta_BRS.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)).values</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>low_brs_hdi <span class="op">=</span> az.hdi(full_c_trace.posterior.intercept <span class="op">-</span> full_c_trace.posterior.beta_BRS).x</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>medhigh_brs_hdi <span class="op">=</span> az.hdi(full_c_trace.posterior.intercept <span class="op">+</span> full_c_trace.posterior.beta_BRS).x</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make arrays of means, lower and upper bounds for the HDI</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>means <span class="op">=</span> np.array([low_brs_mean, medhigh_brs_mean])</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>lowers <span class="op">=</span> np.array([low_brs_hdi[<span class="dv">0</span>], medhigh_brs_hdi[<span class="dv">0</span>]])</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>uppers <span class="op">=</span> np.array([low_brs_hdi[<span class="dv">1</span>], medhigh_brs_hdi[<span class="dv">1</span>]])</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># store HDIs as non-symmetrical errors around the mean</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>ytop <span class="op">=</span> uppers <span class="op">-</span> means</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>ybot <span class="op">=</span> means <span class="op">-</span> lowers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then plot the posterior predictions with the observed data.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(brs_obs, WEMWBS_obs)<span class="op">;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># draw straight line from intercept and slope</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>plot_line(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    full_c_trace.posterior.intercept.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)), </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    full_c_trace.posterior.beta_BRS.mean(dim<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>)), </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="st">'C1'</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="st">'Posterior expected value'</span>, </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>ax.errorbar(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">1.</span>, <span class="fl">1.</span>],</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    means,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    yerr <span class="op">=</span> (ybot, ytop),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    fmt<span class="op">=</span><span class="st">'o'</span>, </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'C3'</span>, </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">'95</span><span class="sc">% c</span><span class="st">redible interval'</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    lw <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> b0, b1 <span class="kw">in</span> (full_c_trace.posterior[[<span class="st">"intercept"</span>, <span class="st">"beta_BRS"</span>]]</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>                        .sel(chain<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>                        .thin(<span class="dv">100</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                        .to_array().T):</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    plot_line(</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>        b0.values, </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>        b1.values, </span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>        c<span class="op">=</span><span class="st">'C2'</span>, </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>        alpha<span class="op">=</span><span class="fl">0.1</span>, </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>)<span class="op">;</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Posterior predictive check for the effect of BRS on WEMWBS"</span>)<span class="op">;</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], [<span class="st">"low"</span>, <span class="st">"medium-high"</span>])</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_pp_check_BRS.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="model-diagnostics" class="level1">
<h1>Model Diagnostics</h1>
<p>Below we show the posterior predictive check for the final, reported model (i.e.&nbsp;the full model with DJG treated as a continuous predictor; full_c_trace). Here the posterior predictive draws and the posterior predictive mean approximate the shape of the observed data, indicating that the model performs well.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ppc <span class="op">=</span> pm.sample_posterior_predictive(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    full_c_trace, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> full_c_model, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">"Y"</span>],</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    random_seed <span class="op">=</span> SEED</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="12000" class="" max="12000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [12000/12000 00:00&lt;00:00]
    </div>
    
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plot_pp_check <span class="op">=</span> az.plot_ppc(ppc)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_pp_check.png'</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>plot_pp_check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>&lt;AxesSubplot:xlabel='Y / Y'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-32-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The trace plot below also shows the marginal posterior estimates for the intercept, BRS, and sigma parameters. The trace plots (right panels) show that the chains mixed well.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plot_trace <span class="op">=</span> az.plot_trace(full_c_trace)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'../img/plot_trace.png'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>plot_trace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[&lt;AxesSubplot:title={'center':'intercept'}&gt;,
        &lt;AxesSubplot:title={'center':'intercept'}&gt;],
       [&lt;AxesSubplot:title={'center':'beta_DJG'}&gt;,
        &lt;AxesSubplot:title={'center':'beta_DJG'}&gt;],
       [&lt;AxesSubplot:title={'center':'beta_BRS'}&gt;,
        &lt;AxesSubplot:title={'center':'beta_BRS'}&gt;],
       [&lt;AxesSubplot:title={'center':'sigma'}&gt;,
        &lt;AxesSubplot:title={'center':'sigma'}&gt;]], dtype=object)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="analysis_files/figure-html/cell-33-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Details of how and why to fit models using monotonic predictors was obtained from:</p>
<p>Bürkner, P. C., &amp; Charpentier, E. (2020). <a href="https://bpspsychub.onlinelibrary.wiley.com/doi/pdf/10.1111/bmsp.12195?casa_token=uc2PZgk3wc4AAAAA:76TREt8u7HFJ-auvEURHDr3yz8kxIgEfn9_1i2SZeagSVXMwPEUj6LutYqOWhOlGDwCOiE0zJIRD4NfESA">Modelling monotonic effects of ordinal predictors in Bayesian regression models</a>. <em>British Journal of Mathematical and Statistical Psychology, 73</em>(3), 420-451.</p>
<p>Modelling code for the main, monotonic model and for plotting posteior draws was adatped from the following sources: - https://github.com/junpenglao/Planet_Sakaar_Data_Science/blob/main/Ports/brms_monotonic_compare.ipynb - https://discourse.pymc.io/t/how-to-build-brms-monotonic-model-with-additional-predictor/4912 - https://austinrochford.com/posts/2018-11-10-monotonic-predictors.html - https://austinrochford.com/posts/intro-prob-prog-pymc.html#ArviZ - https://bayesiancomputationbook.com/notebooks/chp_03.html</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>